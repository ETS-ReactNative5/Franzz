{"ast":null,"code":"import _toConsumableArray from\"/home/hei/Documents/finals/JEK/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"/home/hei/Documents/finals/JEK/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/hei/Documents/finals/JEK/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/hei/Documents/finals/JEK/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";/* eslint-disable jsx-a11y/click-events-have-key-events */ /* eslint-disable jsx-a11y/no-static-element-interactions */ /* eslint-disable jsx-a11y/label-has-associated-control */ /* eslint-disable jsx-a11y/control-has-associated-label */ /* eslint-disable react/prop-types */import React,{useState}from'react';import{LinearProgress}from'@material-ui/core';// import { handleFiles } from '../../Modules/Photos/Scripts/DragAndDropPhotos';\nimport{serverURL}from'../../../../../utils/config';var Input=function Input(_ref){var message=_ref.message,setMessage=_ref.setMessage,emitSendMessage=_ref.emitSendMessage,channel=_ref.channel,setShowEmojiPicker=_ref.setShowEmojiPicker;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showProgress=_useState2[0],toggleProgress=_useState2[1];var uploadFile=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(file,channelId,albumName,emitSendMessage,viewUpdatedAlbum){var url,formData,path;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:url=\"\".concat(serverURL,\"/api/photos/uploadPhotos\");formData=new FormData();formData.append('file',file);formData.append('channel',\"\".concat(channelId));path=\"albums/\".concat(albumName.replace(/ /g,'-'));if(albumName==='chat'){path='chat';}formData.append('album',path);fetch(url,{method:'POST',body:formData})// send the url of image/video to socket to be used for messaging\n.then(function(res){return res.json();}).then(function(data){if(albumName==='chat'){emitSendMessage(data.result.url,data.video,data.image);}else{setTimeout(function(){viewUpdatedAlbum();},3000);}}).catch(function(err){console.log(err);});case 8:case\"end\":return _context.stop();}}},_callee);}));return function uploadFile(_x,_x2,_x3,_x4,_x5){return _ref2.apply(this,arguments);};}();var handleFiles=function handleFiles(files,channelId,albumName,emitSendMessage,viewUpdatedAlbum){_toConsumableArray(files).forEach(function(file){uploadFile(file,channelId,albumName,emitSendMessage,viewUpdatedAlbum);});};var sendMessage=function sendMessage(e){e.preventDefault();toggleProgress(true);emitSendMessage(message);toggleProgress(false);setMessage('');};var sendFileMessage=function sendFileMessage(e){toggleProgress(true);handleFiles(e.target.files,channel,'chat',emitSendMessage);setTimeout(function(){toggleProgress(false);},1000);};return React.createElement(\"div\",null,showProgress&&React.createElement(LinearProgress,null),React.createElement(\"form\",{id:\"messaging-input\"},React.createElement(\"textarea\",{className:\"chatInputBox\",type:\"text\",onChange:function onChange(e){return setMessage(e.target.value);},value:message,onKeyPress:function onKeyPress(e){return e.key==='Enter'?sendMessage(e):null;},placeholder:\"Type something to send...\"}),React.createElement(\"div\",{className:\"emojiPickerButton\",onClick:function onClick(){return setShowEmojiPicker(function(prev){return!prev;});}}),React.createElement(\"input\",{type:\"file\",id:\"fileElem\",multiple:true,accept:\"image/*\",onChange:function onChange(e){return sendFileMessage(e);}}),React.createElement(\"label\",{className:\"button\",htmlFor:\"fileElem\"})));};export default Input;","map":{"version":3,"sources":["/home/hei/Documents/finals/JEK/client/src/components/Home/Channel/Container/Chat/Input.js"],"names":["React","useState","LinearProgress","serverURL","Input","message","setMessage","emitSendMessage","channel","setShowEmojiPicker","showProgress","toggleProgress","uploadFile","file","channelId","albumName","viewUpdatedAlbum","url","formData","FormData","append","path","replace","fetch","method","body","then","res","json","data","result","video","image","setTimeout","catch","err","console","log","handleFiles","files","forEach","sendMessage","e","preventDefault","sendFileMessage","target","value","key","prev"],"mappings":"qeAAA,0D,CACA,4D,CACA,0D,CACA,0D,CACA,qCACA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,KAAgC,OAAhC,CACA,OAASC,cAAT,KAA+B,mBAA/B,CACA;AAEA,OAASC,SAAT,KAA0B,6BAA1B,CAEA,GAAMC,CAAAA,KAAK,CAAG,QAARA,CAAAA,KAAQ,MAER,IADJC,CAAAA,OACI,MADJA,OACI,CADKC,UACL,MADKA,UACL,CADiBC,eACjB,MADiBA,eACjB,CADkCC,OAClC,MADkCA,OAClC,CAD2CC,kBAC3C,MAD2CA,kBAC3C,eACmCR,QAAQ,CAAC,KAAD,CAD3C,wCACGS,YADH,eACiBC,cADjB,eAGJ,GAAMC,CAAAA,UAAU,2FAAG,iBAAOC,IAAP,CAAaC,SAAb,CAAwBC,SAAxB,CAAmCR,eAAnC,CAAoDS,gBAApD,wIACXC,GADW,WACFd,SADE,6BAEXe,QAFW,CAEA,GAAIC,CAAAA,QAAJ,EAFA,CAGjBD,QAAQ,CAACE,MAAT,CAAgB,MAAhB,CAAwBP,IAAxB,EACAK,QAAQ,CAACE,MAAT,CAAgB,SAAhB,WAA8BN,SAA9B,GACIO,IALa,kBAKIN,SAAS,CAACO,OAAV,CAAkB,IAAlB,CAAwB,GAAxB,CALJ,EAMjB,GAAIP,SAAS,GAAK,MAAlB,CAA0B,CACxBM,IAAI,CAAG,MAAP,CACD,CACDH,QAAQ,CAACE,MAAT,CAAgB,OAAhB,CAAyBC,IAAzB,EAGAE,KAAK,CAACN,GAAD,CAAM,CACTO,MAAM,CAAE,MADC,CAETC,IAAI,CAAEP,QAFG,CAAN,CAIH;AAJF,CAKGQ,IALH,CAKQ,SAACC,GAAD,QAASA,CAAAA,GAAG,CAACC,IAAJ,EAAT,EALR,EAMGF,IANH,CAMQ,SAACG,IAAD,CAAU,CACd,GAAId,SAAS,GAAK,MAAlB,CAA0B,CACxBR,eAAe,CAACsB,IAAI,CAACC,MAAL,CAAYb,GAAb,CAAkBY,IAAI,CAACE,KAAvB,CAA8BF,IAAI,CAACG,KAAnC,CAAf,CACD,CAFD,IAEO,CACLC,UAAU,CAAC,UAAM,CACfjB,gBAAgB,GACjB,CAFS,CAEP,IAFO,CAAV,CAGD,CACF,CAdH,EAeGkB,KAfH,CAeS,SAACC,GAAD,CAAS,CAAEC,OAAO,CAACC,GAAR,CAAYF,GAAZ,EAAmB,CAfvC,EAZiB,sDAAH,kBAAVvB,CAAAA,UAAU,6DAAhB,CA8BA,GAAM0B,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,CAACC,KAAD,CAAQzB,SAAR,CAAmBC,SAAnB,CAA8BR,eAA9B,CAA+CS,gBAA/C,CAAoE,CACtF,mBAAIuB,KAAJ,EAAWC,OAAX,CAAmB,SAAC3B,IAAD,CAAU,CAC3BD,UAAU,CAACC,IAAD,CAAOC,SAAP,CAAkBC,SAAlB,CAA6BR,eAA7B,CAA8CS,gBAA9C,CAAV,CACD,CAFD,EAGD,CAJD,CAMA,GAAMyB,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,CAACC,CAAD,CAAO,CACzBA,CAAC,CAACC,cAAF,GACAhC,cAAc,CAAC,IAAD,CAAd,CACAJ,eAAe,CAACF,OAAD,CAAf,CACAM,cAAc,CAAC,KAAD,CAAd,CACAL,UAAU,CAAC,EAAD,CAAV,CACD,CAND,CAQA,GAAMsC,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,CAACF,CAAD,CAAO,CAC7B/B,cAAc,CAAC,IAAD,CAAd,CACA2B,WAAW,CAACI,CAAC,CAACG,MAAF,CAASN,KAAV,CAAiB/B,OAAjB,CAA0B,MAA1B,CAAkCD,eAAlC,CAAX,CACA0B,UAAU,CAAC,UAAM,CACftB,cAAc,CAAC,KAAD,CAAd,CACD,CAFS,CAEP,IAFO,CAAV,CAGD,CAND,CAQA,MACE,gCACGD,YAAY,EAAI,oBAAC,cAAD,MADnB,CAEE,4BAAM,EAAE,CAAC,iBAAT,EACE,gCACE,SAAS,CAAC,cADZ,CAEE,IAAI,CAAC,MAFP,CAGE,QAAQ,CAAE,kBAACgC,CAAD,QAAOpC,CAAAA,UAAU,CAACoC,CAAC,CAACG,MAAF,CAASC,KAAV,CAAjB,EAHZ,CAIE,KAAK,CAAEzC,OAJT,CAKE,UAAU,CAAE,oBAACqC,CAAD,QAAQA,CAAAA,CAAC,CAACK,GAAF,GAAU,OAAV,CAAoBN,WAAW,CAACC,CAAD,CAA/B,CAAqC,IAA7C,EALd,CAME,WAAW,CAAC,2BANd,EADF,CASE,2BAAK,SAAS,CAAC,mBAAf,CAAmC,OAAO,CAAE,yBAAMjC,CAAAA,kBAAkB,CAAC,SAACuC,IAAD,QAAU,CAACA,IAAX,EAAD,CAAxB,EAA5C,EATF,CAUE,6BAAO,IAAI,CAAC,MAAZ,CAAmB,EAAE,CAAC,UAAtB,CAAiC,QAAQ,KAAzC,CAA0C,MAAM,CAAC,SAAjD,CAA2D,QAAQ,CAAE,kBAACN,CAAD,QAAOE,CAAAA,eAAe,CAACF,CAAD,CAAtB,EAArE,EAVF,CAWE,6BAAO,SAAS,CAAC,QAAjB,CAA0B,OAAO,CAAC,UAAlC,EAXF,CAFF,CADF,CAkBD,CA3ED,CA6EA,cAAetC,CAAAA,KAAf","sourcesContent":["/* eslint-disable jsx-a11y/click-events-have-key-events */\n/* eslint-disable jsx-a11y/no-static-element-interactions */\n/* eslint-disable jsx-a11y/label-has-associated-control */\n/* eslint-disable jsx-a11y/control-has-associated-label */\n/* eslint-disable react/prop-types */\nimport React, { useState } from 'react';\nimport { LinearProgress } from '@material-ui/core';\n// import { handleFiles } from '../../Modules/Photos/Scripts/DragAndDropPhotos';\n\nimport { serverURL } from '../../../../../utils/config';\n\nconst Input = ({\n  message, setMessage, emitSendMessage, channel, setShowEmojiPicker,\n}) => {\n  const [showProgress, toggleProgress] = useState(false);\n\n  const uploadFile = async (file, channelId, albumName, emitSendMessage, viewUpdatedAlbum) => {\n    const url = `${serverURL}/api/photos/uploadPhotos`;\n    const formData = new FormData();\n    formData.append('file', file);\n    formData.append('channel', `${channelId}`);\n    let path = `albums/${albumName.replace(/ /g, '-')}`;\n    if (albumName === 'chat') {\n      path = 'chat';\n    }\n    formData.append('album', path);\n\n\n    fetch(url, {\n      method: 'POST',\n      body: formData,\n    })\n      // send the url of image/video to socket to be used for messaging\n      .then((res) => res.json())\n      .then((data) => {\n        if (albumName === 'chat') {\n          emitSendMessage(data.result.url, data.video, data.image);\n        } else {\n          setTimeout(() => {\n            viewUpdatedAlbum();\n          }, 3000);\n        }\n      })\n      .catch((err) => { console.log(err); });\n  };\n\n  const handleFiles = (files, channelId, albumName, emitSendMessage, viewUpdatedAlbum) => {\n    [...files].forEach((file) => {\n      uploadFile(file, channelId, albumName, emitSendMessage, viewUpdatedAlbum);\n    });\n  };\n\n  const sendMessage = (e) => {\n    e.preventDefault();\n    toggleProgress(true);\n    emitSendMessage(message);\n    toggleProgress(false);\n    setMessage('');\n  };\n\n  const sendFileMessage = (e) => {\n    toggleProgress(true);\n    handleFiles(e.target.files, channel, 'chat', emitSendMessage);\n    setTimeout(() => {\n      toggleProgress(false);\n    }, 1000);\n  };\n\n  return (\n    <div>\n      {showProgress && <LinearProgress />}\n      <form id=\"messaging-input\">\n        <textarea\n          className=\"chatInputBox\"\n          type=\"text\"\n          onChange={(e) => setMessage(e.target.value)}\n          value={message}\n          onKeyPress={(e) => (e.key === 'Enter' ? sendMessage(e) : null)}\n          placeholder=\"Type something to send...\"\n        />\n        <div className=\"emojiPickerButton\" onClick={() => setShowEmojiPicker((prev) => !prev)} />\n        <input type=\"file\" id=\"fileElem\" multiple accept=\"image/*\" onChange={(e) => sendFileMessage(e)} />\n        <label className=\"button\" htmlFor=\"fileElem\" />\n      </form>\n    </div>\n  );\n};\n\nexport default Input;\n"]},"metadata":{},"sourceType":"module"}