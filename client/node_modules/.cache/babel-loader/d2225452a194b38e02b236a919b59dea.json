{"ast":null,"code":"import _toConsumableArray from\"/home/hei/Documents/finals/JEK/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"/home/hei/Documents/finals/JEK/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/hei/Documents/finals/JEK/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";var _require=require('../../../../../../utils/config'),serverURL=_require.serverURL;var preventDefaults=function preventDefaults(e){e.preventDefault();e.stopPropagation();};var uploadFile=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(file,channelId,albumName,emitSendMessage,viewUpdatedAlbum){var url,formData,path;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:url=\"\".concat(serverURL,\"/api/photos/uploadPhotos\");formData=new FormData();formData.append('file',file);formData.append('channel',\"\".concat(channelId));path=\"albums/\".concat(albumName.replace(/ /g,'-'));if(albumName==='chat'){path='chat';}formData.append('album',path);fetch(url,{method:'POST',body:formData})// send the url of image/video to socket to be used for messaging\n.then(function(res){return res.json();}).then(function(data){if(albumName==='chat'){emitSendMessage(data.result.url,data.video,data.image);}else{setTimeout(function(){viewUpdatedAlbum();},3000);}}).catch(function(err){console.log(err);});case 8:case\"end\":return _context.stop();}}},_callee);}));return function uploadFile(_x,_x2,_x3,_x4,_x5){return _ref.apply(this,arguments);};}();var handleFiles=function handleFiles(files,channelId,albumName,emitSendMessage,viewUpdatedAlbum){_toConsumableArray(files).forEach(function(file){uploadFile(file,channelId,albumName,emitSendMessage,viewUpdatedAlbum);});};var handleDrop=function handleDrop(e,channelId,albumName,emitSendMessage){// get emitsendmessage to be passed through as a function\npreventDefaults(e);var dt=e.dataTransfer;var files=dt.files;handleFiles(files,channelId,albumName,emitSendMessage);};module.exports={preventDefaults:preventDefaults,handleDrop:handleDrop,handleFiles:handleFiles};","map":{"version":3,"sources":["/home/hei/Documents/finals/JEK/client/src/components/Home/Channel/Modules/Photos/Scripts/DragAndDropPhotos.js"],"names":["require","serverURL","preventDefaults","e","preventDefault","stopPropagation","uploadFile","file","channelId","albumName","emitSendMessage","viewUpdatedAlbum","url","formData","FormData","append","path","replace","fetch","method","body","then","res","json","data","result","video","image","setTimeout","catch","err","console","log","handleFiles","files","forEach","handleDrop","dt","dataTransfer","module","exports"],"mappings":"0XAAsBA,OAAO,CAAC,gCAAD,C,CAArBC,S,UAAAA,S,CAER,GAAMC,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,CAACC,CAAD,CAAO,CAC7BA,CAAC,CAACC,cAAF,GACAD,CAAC,CAACE,eAAF,GACD,CAHD,CAKA,GAAMC,CAAAA,UAAU,0FAAG,iBAAOC,IAAP,CAAaC,SAAb,CAAwBC,SAAxB,CAAmCC,eAAnC,CAAoDC,gBAApD,wIACXC,GADW,WACFX,SADE,6BAEXY,QAFW,CAEA,GAAIC,CAAAA,QAAJ,EAFA,CAGjBD,QAAQ,CAACE,MAAT,CAAgB,MAAhB,CAAwBR,IAAxB,EACAM,QAAQ,CAACE,MAAT,CAAgB,SAAhB,WAA8BP,SAA9B,GACIQ,IALa,kBAKIP,SAAS,CAACQ,OAAV,CAAkB,IAAlB,CAAwB,GAAxB,CALJ,EAMjB,GAAIR,SAAS,GAAK,MAAlB,CAA0B,CACxBO,IAAI,CAAG,MAAP,CACD,CACDH,QAAQ,CAACE,MAAT,CAAgB,OAAhB,CAAyBC,IAAzB,EAGAE,KAAK,CAACN,GAAD,CAAM,CACTO,MAAM,CAAE,MADC,CAETC,IAAI,CAAEP,QAFG,CAAN,CAIH;AAJF,CAKGQ,IALH,CAKQ,SAACC,GAAD,QAASA,CAAAA,GAAG,CAACC,IAAJ,EAAT,EALR,EAMGF,IANH,CAMQ,SAACG,IAAD,CAAU,CACd,GAAIf,SAAS,GAAK,MAAlB,CAA0B,CACxBC,eAAe,CAACc,IAAI,CAACC,MAAL,CAAYb,GAAb,CAAkBY,IAAI,CAACE,KAAvB,CAA8BF,IAAI,CAACG,KAAnC,CAAf,CACD,CAFD,IAEO,CACLC,UAAU,CAAC,UAAM,CACfjB,gBAAgB,GACjB,CAFS,CAEP,IAFO,CAAV,CAGD,CACF,CAdH,EAeGkB,KAfH,CAeS,SAACC,GAAD,CAAS,CAAEC,OAAO,CAACC,GAAR,CAAYF,GAAZ,EAAmB,CAfvC,EAZiB,sDAAH,kBAAVxB,CAAAA,UAAU,4DAAhB,CA8BA,GAAM2B,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,CAACC,KAAD,CAAQ1B,SAAR,CAAmBC,SAAnB,CAA8BC,eAA9B,CAA+CC,gBAA/C,CAAoE,CACtF,mBAAIuB,KAAJ,EAAWC,OAAX,CAAmB,SAAC5B,IAAD,CAAU,CAC3BD,UAAU,CAACC,IAAD,CAAOC,SAAP,CAAkBC,SAAlB,CAA6BC,eAA7B,CAA8CC,gBAA9C,CAAV,CACD,CAFD,EAGD,CAJD,CAMA,GAAMyB,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,CAACjC,CAAD,CAAIK,SAAJ,CAAeC,SAAf,CAA0BC,eAA1B,CAA8C,CAC/D;AACAR,eAAe,CAACC,CAAD,CAAf,CACA,GAAMkC,CAAAA,EAAE,CAAGlC,CAAC,CAACmC,YAAb,CAH+D,GAIvDJ,CAAAA,KAJuD,CAI7CG,EAJ6C,CAIvDH,KAJuD,CAM/DD,WAAW,CAACC,KAAD,CAAQ1B,SAAR,CAAmBC,SAAnB,CAA8BC,eAA9B,CAAX,CACD,CAPD,CASA6B,MAAM,CAACC,OAAP,CAAiB,CACftC,eAAe,CAAfA,eADe,CAEfkC,UAAU,CAAVA,UAFe,CAGfH,WAAW,CAAXA,WAHe,CAAjB","sourcesContent":["const { serverURL } = require('../../../../../../utils/config');\n\nconst preventDefaults = (e) => {\n  e.preventDefault();\n  e.stopPropagation();\n};\n\nconst uploadFile = async (file, channelId, albumName, emitSendMessage, viewUpdatedAlbum) => {\n  const url = `${serverURL}/api/photos/uploadPhotos`;\n  const formData = new FormData();\n  formData.append('file', file);\n  formData.append('channel', `${channelId}`);\n  let path = `albums/${albumName.replace(/ /g, '-')}`;\n  if (albumName === 'chat') {\n    path = 'chat';\n  }\n  formData.append('album', path);\n\n\n  fetch(url, {\n    method: 'POST',\n    body: formData,\n  })\n    // send the url of image/video to socket to be used for messaging\n    .then((res) => res.json())\n    .then((data) => {\n      if (albumName === 'chat') {\n        emitSendMessage(data.result.url, data.video, data.image);\n      } else {\n        setTimeout(() => {\n          viewUpdatedAlbum();\n        }, 3000);\n      }\n    })\n    .catch((err) => { console.log(err); });\n};\n\nconst handleFiles = (files, channelId, albumName, emitSendMessage, viewUpdatedAlbum) => {\n  [...files].forEach((file) => {\n    uploadFile(file, channelId, albumName, emitSendMessage, viewUpdatedAlbum);\n  });\n};\n\nconst handleDrop = (e, channelId, albumName, emitSendMessage) => {\n  // get emitsendmessage to be passed through as a function\n  preventDefaults(e);\n  const dt = e.dataTransfer;\n  const { files } = dt;\n\n  handleFiles(files, channelId, albumName, emitSendMessage);\n};\n\nmodule.exports = {\n  preventDefaults,\n  handleDrop,\n  handleFiles,\n};\n"]},"metadata":{},"sourceType":"module"}